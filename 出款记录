import sys, os, time, configparser, unicodedata
from datetime import datetime, timedelta, timezone
from collections import defaultdict
import requests
from PyQt5.QtCore import Qt, QTimer, QByteArray
from PyQt5.QtGui import (
    QFont, QPainter, QPixmap, QColor, QPalette, QBrush, QIntValidator, QIcon
)
from PyQt5.QtWidgets import (
    QApplication, QMainWindow, QWidget, QVBoxLayout, QHBoxLayout, QGridLayout,
    QLineEdit, QTextEdit, QPushButton, QMessageBox,
    QPlainTextEdit, QLabel, QGroupBox, QProgressBar, QCheckBox, QFileDialog
)

APP_TITLE = "å‡ºæ¬¾è®°å½•"
APP_DIR = os.path.dirname(os.path.abspath(__file__))
CONFIG_FILE = os.path.join(APP_DIR, "config.ini")

API_PATH = "/api/transfermodule/WithdrawRecord/GetPageListAsync"
PAGE_SIZE = 50
REQUEST_INTERVAL_SECONDS = 0.12

# ---------- å·¥å…·å‡½æ•° ----------
def robust_parse_dt(s: str):
    if not s:
        return None
    s = s.strip()
    z = s.endswith("Z")
    if z:
        s = s[:-1]
    fmts = [
        "%Y-%m-%d %H:%M:%S","%Y-%m-%d %H:%M",
        "%Y-%m-%dT%H:%M:%S.%f","%Y-%m-%dT%H:%M:%S",
        "%Y/%m/%d %H:%M:%S","%Y/%m/%d %H:%M",
    ]
    for fmt in fmts:
        try:
            dt = datetime.strptime(s, fmt)
            if z:
                dt = dt.replace(tzinfo=timezone.utc).astimezone().replace(tzinfo=None)
            return dt
        except ValueError:
            continue
    try:
        return datetime.fromisoformat(s)
    except Exception:
        return None

def build_tianzige_background(cell=22, line_color=QColor(230,230,230), bold_color=QColor(210,210,210)):
    pix = QPixmap(cell*4, cell*4)
    pix.fill(Qt.white)
    p = QPainter(pix); p.setRenderHint(QPainter.Antialiasing, False)
    p.setPen(line_color)
    for x in range(0, pix.width(), cell): p.drawLine(x,0,x,pix.height())
    for y in range(0, pix.height(), cell): p.drawLine(0,y,pix.width(),y)
    p.setPen(bold_color); step = cell*2
    for x in range(0, pix.width(), step): p.drawLine(x,0,x,pix.height())
    for y in range(0, pix.height(), step): p.drawLine(0,y,pix.width(),y)
    p.end()
    return pix

def nice_sep(char="-", width=72): return char*width

def ea_width(s: str) -> int:
    """East Asian æ˜¾ç¤ºå®½åº¦ï¼šä¸­æ–‡å…¨è§’=2ï¼ŒASCII=1"""
    w = 0
    for ch in s:
        e = unicodedata.east_asian_width(ch)
        w += 2 if e in ("F","W") else 1
    return w

def pad_right_ea(s: str, total_width: int) -> str:
    cur = ea_width(s)
    spaces = max(0, total_width - cur)
    return s + " " * spaces

# ---------- Toastï¼ˆæ°”æ³¡æç¤ºï¼‰ ----------
# ç”¨è¿™ä¸ªæ›¿æ¢ä½ ä»£ç ä¸­çš„ Toast ç±»
class Toast(QLabel):
    def __init__(self, parent, text, ms=2000):
        super().__init__(parent)
        self.setText(text)
        self.setStyleSheet("""
            QLabel {
                background: rgba(0,0,0,0.75);
                color: #fff;
                padding: 10px 18px;
                border-radius: 10px;
                font-size: 13px;
            }
        """)
        self.setAttribute(Qt.WA_TransparentForMouseEvents)
        self.adjustSize()

        # â€”â€” å±…ä¸­å®šä½ï¼ˆç›¸å¯¹ parent çš„å¯è§†åŒºåŸŸï¼‰â€”â€”
        pr = parent.rect()
        x = pr.center().x() - self.width() // 2
        y = pr.center().y() - self.height() // 2
        # å¦‚æœæƒ³ç¨å¾®åä¸‹æ˜¾ç¤ºä¸€ç‚¹ï¼Œå¯ä»¥åŠ ä¸€ä¸ªåç§»é‡ï¼Œæ¯”å¦‚ +40ï¼š
        # y += 40
        self.move(x, y)

        self.show()
        QTimer.singleShot(ms, self.close)


# ---------- ä¸»çª—ä½“ ----------
class MainWindow(QMainWindow):
    def __init__(self):
        super().__init__()
        self.setWindowTitle(APP_TITLE)
        self.resize(1100, 760)
        self.check_network_validation()

        # åŠ è½½ base64 å›¾æ ‡ï¼ˆç¡®ä¿å­—ç¬¦ä¸²å®Œæ•´ï¼‰
        icon_base64 = "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//8iV///Ilf//yJX//8iV///Ilf//yJW//IiV/+HGFX/FQAAAAAAAAAAAAAAACFV/ychV//OIlf/5AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAIVj/PSFW/88iV///Ilf//yJX//8iV///Ilf//yJX//8iV///Ilf//yJX//8iV///Ilf//yJX//8iV///Ilf//yJX//8iV//2Ilf/ryJX/5AiV/+1Ilf/+iJX//8iV//aAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAJEn/ByFW/5IiVv/+Ilf//yJX//8iV///Ilf//yJX//8iV///Ilf//yJX//8iV///Ilf//yJX//8iV///Ilf//yJX//8iV///Ilf//yJX//8iV///Ilf//yJX//8iV///Ilf//yJX/6UAAAAAAAAAAAAAAAAAAAAAAAAAACBV/xghVv/JIlf//yJX//8iV///Ilf//yJX//8iV///Ilf//yJX//8iV///Ilf//yJX//8iV///Ilf//yJX//8iV///Ilf//yJX//8iV///Ilf//yJX//8iV///Ilf//yJX//8iV///Ilf/TAAAAAAAAAAAAAAAAAAAAAAhWv8fIVf/3SJX//8iV///Ilf//yJX/+giVv+9IVf/oSJX/5YiV/+cIlb/tCJX/98iV///Ilf//yJX//8iV///Ilf//yJX//8iV///Ilf//yJX//8iV///Ilf//yJX//8iV///Ilf//yFX/84AAP8BAAAAAAAAAAAAAAAAIVn/FyJX/9wiV///Ilb/ySJV/28jVf8kAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAACFS/x8hV/91Ilf/4CJX//8iV///Ilf//yJX//8iV///Ilf//yJX//8iV///Ilf//yJX//8hV//8IFf/OAAAAAAAAAAAAAAAACpV/wYiV//FIlf/rSJY/zQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAACpV/wYgVv+OIlf//yJX//8iV///Ilf//yJX//8iV///Ilf//yJX//8iV///Ilf//yJW/4gAAAAAAAAAAAAAAAAAAAAAIVf/VSBT/zcAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAhWf8XIlf/xSJX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AAAAAAAAIlb/dyJX//8hVv/PG1H/EwAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAIGD/CABV/wMAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABxV/wkhV//lIVf/wh5a/xEAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAIVj/eiJX/5wkSf8HAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAACFZ/xciVv9TAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAKAAAADAAAABgAAAAAQAgAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAD/AUBA/wQqVf8GJEn/BzNm/wUAAP8BAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA/wEgUP8QHlX/MyJW/1MhWP9rIlf/fiNW/4whV/+SIVb/lCJX/40iVv9/I1f/ZiJW/0QgVf8YAAD/AQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAACFT/y4hWf8XAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAaTf8KIlf/TCFY/6AjV//VIVf/5SJX//AiV//4Ilf//iJX//8iV///Ilf//yJX//8iVv/+Ilf/9yJX/+siV//YIlf/liNX/ywAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAJFv/KiJX/9AjV/9JAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAcVf8JHVf/IyFW/3whV//fIlf//yJX//8iV///Ilf//yJX//8iV///Ilf//yJX//8iV///Ilf//yJX//8iV///Ilf//yJX//8iV///Ilf//yJW//ghVv+gIVf/Lxdd/wsAAAAAAAAAAAAAAAAAAAAAAAAAACpV/wYkWP9AIVj/3SJX//UhWP9jAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAACNU/zoiVv+UIlf/5CJX//8iV///Ilf//yJX//8iV///Ilf//yJX//8iV///Ilf//yJX//8iV///Ilf//yJX//8iV///Ilf//yJX//8iV///Ilf//yJX//8iV///Ilf/6iJX/54gWP9XIlP/JSBg/xAcVf8bI1X/QiFX/4oiV//iIlf//yJX//YhVv9lAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAbXv8TIlf/kCJX/+giV//8Ilf//yJX//8iV///Ilf//yJX//8iV///Ilf//yJX//8iV///Ilf//yJX//8iV///Ilf//yJX//8iV///Ilf//yJX//8iV///Ilf//yJX//8iV///Ilf//yJX//4iV//xIlf/4SJX/9ohV//dIlf/6iJX//wiV///Ilf//yJX//EhV/9VAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAQED/BCBY/zciV//IIlf//iJX//8iV///Ilf//yJX//8iV///Ilf//yJX//8iV///Ilf//yJX//8iV///Ilf//yJX//8iV///Ilf//yJX//8iV///Ilf//yJX//8iV///Ilf//yJX//8iV///Ilf//yJX//8iV///Ilf//yJX//8iV///Ilf//yJX//8iV///Ilf//yNX/+UkV/8yAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAgUP8QIVb/cyJX/+ciV///Ilf//yJX//8iV///Ilf//yJX//8iV///Ilf//yJX//8iV///Ilf//yJX//8iV///Ilf//yJX//8iV///Ilf//yJX//8iV///Ilf//yJX//8iV///Ilf//yJX//8iV///Ilf//yJX//8iV///Ilf//yJX//8iV///Ilf//yJX//8iV///Ilf//yJW/8MaTf8KAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAACdi/w0iV/+VIlf/9iJX//8iV///Ilf//yJX//8iV///Ilf//yJX//8iV///Ilf//yJX//8iV///Ilf//yJX//8iV///Ilf//yJX//8iV///Ilf//yJX//8iV///Ilf//yJX//8iV///Ilf//yJX//8iV///Ilf//yJX//8iV///Ilf//yJX//8iV///Ilf//yJX//8iV///Ilf//yJX/2EAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAHFX/EiNW/6EiV///Ilf//yJX//8iV///Ilf//yJX//oiV//vIlf/5yJX/+EhV//dIlf/3CNX/90iV//hIlf/6CJX//EiV//8Ilf//yJX//8iV///Ilf//yJX//8iV///Ilf//yJX//8iV///Ilf//yJX//8iV///Ilf//yJX//8iV///Ilf//yJX//8iV///Ilf//yJX//8iV///Ilf/0kBA/wQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAjWP8dIVf/qCJX//8iV///Ilf//yJX//YhV//HIVf/mSJY/3EfWP9RIFj/NyJT/yUdWP8aIVn/FydY/xoiV/8mI1j/OiNY/1chVv98Ilf/qiJX/+EiV//+Ilf//yJX//8iV///Ilf//yJX//8iV///Ilf//yJX//8iV///Ilf//yJX//8iV///Ilf//yJX//8iV///Ilf//yJX//8iVv/vIlf/TAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAACdO/w0hWP+aIlf/+yJX//8iV//nIVb/iyRX/zIgVf8YHFX/CQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAgP8CJFv/DiJa/yUhVv9zIlf/6CJX//8iV///Ilf//yJX//8iV///Ilf//yJX//8iV///Ilf//yJX//8iV///Ilf//yJX//8iV///Ilf//yJX//0iV/+YGmb/CgAAAAAAAAAAAAAAAAAAAAAAAAAAAFX/AyFW/3MiV//zIlf/2SBW/3YaWf8UAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA/wEcVf8SIlf/gSJX//8iV///Ilf//yJX//8iV///Ilf//yJX//8iV///Ilf//yJX//8iV///Ilf//yJX//8iV///Ilf//yJX/9giU/8lAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAIFf/WCJW/8MgV/9vHVj/GgAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAACJb/y0iV/+tIlf/+SJX//8iV///Ilf//yJX//8iV///Ilf//yJX//8iV///Ilf//yJX//8iV///Ilf//yJX//8iV///Ilf//yJX/74AQP8EAAAAAAAAAAAAAAAAAAAAAAAAAAAgWP8gIlb/WR1Y/xoAVf8DAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAIFT/QCFX/94iV//9Ilf//yJX//8iV///Ilf//yJX//8iV///Ilf//yJX//8iV///Ilf//yJX//8iV///Ilf//yJX//8iV///Ilf//yJX/+AiWv8lAAAAAAAAAAAAAAAAAAAAAAAAAAAAAP8BAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAEBA/wQiVv9TIlj/6yJX//8iV///Ilf//yJX//8iV///Ilf//yJX//8iV///Ilf//yJX//8iV///Ilf//yJX//8iV///Ilf//yJX//8iV///Ilf//yFX/+0iVv9KAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAACJX/2EiV//iIlf//yJX//8iV///Ilf//yJX//8iV///Ilf//yJX//8iV///Ilf//yJX//8iV///Ilf//yJX//8iV///Ilf//yJX//8iV///Ilf//yJX//YhWP9jAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAP8BI1f/bCJX//EiV///Ilf//yJX//8iV///Ilf//yJX//8iV///Ilf//yJX//8iV///Ilf//yJX//8iV///Ilf//yJX//8iV///Ilf//yJX//8iV///Ilf//yJX//shVv90AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAEBA/wQhWP9jIlf/8SJX//8iV///Ilf//yJX//8iV///Ilf//yJX//8iV///Ilf//yJX//8iV///Ilf//yJX//8iV///Ilf//yJX//8iV///Ilf//yJX//8iV///Ilf//yJX//0hV/97AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA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AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAACFX/1UiVv/PIFn/PwBA/wQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAHFX/EiJX/58hVf8nAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAIlP/JSJV/w8AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA=="  # æ›¿æ¢æˆä½ çš„ base64
        icon_data = QByteArray.fromBase64(icon_base64.encode())

        # æ›´å¯é çš„å›¾æ ‡åŠ è½½æ–¹å¼
        pixmap = QPixmap()
        if not pixmap.loadFromData(icon_data, "ICO"):  # æ˜¾å¼æŒ‡å®šæ ¼å¼
            print("âŒ å›¾æ ‡åŠ è½½å¤±è´¥ï¼è¯·æ£€æŸ¥ base64 æ•°æ®æˆ–æ–‡ä»¶æ ¼å¼")
        else:
            self.setWindowIcon(QIcon(pixmap))  # è®¾ç½®çª—å£å’Œä»»åŠ¡æ å›¾æ ‡

        self._port_cache = ""
        self._token_cache = ""

        self.setStyleSheet("""
        QWidget { font-size: 13px; } /* è®¾ç½®æ•´ä¸ªåº”ç”¨ç•Œé¢çš„åŸºç¡€å­—ä½“å¤§å°ä¸º 13åƒç´  */
        QGroupBox { 
            font-weight: bold; /* æ ‡é¢˜å­—ä½“åŠ ç²— */
            border: 1px solid #dcdcdc; /* è¾¹æ¡†æ ·å¼ï¼š1åƒç´ å®çº¿ï¼Œé¢œè‰²ä¸ºæµ…ç°è‰² (#dcdcdc) */
            border-radius: 8px; /* è¾¹æ¡†åœ†è§’åŠå¾„ä¸º 8åƒç´  */
            margin-top: 10px; /* é¡¶éƒ¨å¤–è¾¹è·ä¸º 10åƒç´  (ç»™æ ‡é¢˜ç•™å‡ºç©ºé—´) */
            padding: 10px; /* å†…éƒ¨å¡«å……/å†…è¾¹è·ä¸º 10åƒç´  */
        }
        QGroupBox:title {
            subcontrol-origin: margin; /* è®¾ç½®æ ‡é¢˜çš„èµ·ç‚¹ä¸ºå¤–è¾¹è· (margin) */
            subcontrol-position: top left; /* è®¾ç½®æ ‡é¢˜çš„ä½ç½®åœ¨é¡¶éƒ¨å·¦ä¾§ */
            padding: 0 6px; /* æ ‡é¢˜çš„å†…è¾¹è·ï¼šä¸Šä¸‹ 0ï¼Œå·¦å³ 6åƒç´  (è®©æ ‡é¢˜è„±ç¦»è¾¹æ¡†) */
        }
        QPushButton { 
            height: 32px; /* æŒ‰é’®é«˜åº¦ä¸º 32åƒç´  */
            padding: 0 14px; /* å†…è¾¹è·ï¼šä¸Šä¸‹ 0ï¼Œå·¦å³ 14åƒç´  */
            border: 1px solid #c8c8c8; /* è¾¹æ¡†æ ·å¼ï¼š1åƒç´ å®çº¿ï¼Œé¢œè‰²ä¸ºä¸­ç°è‰² (#c8c8c8) */
            border-radius: 6px; /* è¾¹æ¡†åœ†è§’åŠå¾„ä¸º 6åƒç´  */
            background: #f7f7f7; /* èƒŒæ™¯é¢œè‰²ä¸ºæµ…ç°è‰² (#f7f7f7) */
        }
        QPushButton:hover { background: #f0f0f0; } /* é¼ æ ‡æ‚¬åœæ—¶èƒŒæ™¯é¢œè‰²å˜æ·± (#f0f0f0) */
        QPushButton:pressed { background: #e8e8e8; } /* æŒ‰é’®è¢«æŒ‰ä¸‹æ—¶èƒŒæ™¯é¢œè‰²è¿›ä¸€æ­¥å˜æ·± (#e8e8e8) */
        QLineEdit, QPlainTextEdit, QTextEdit {
            border: 1px solid #dcdcdc; /* è¾¹æ¡†æ ·å¼ï¼š1åƒç´ å®çº¿ï¼Œé¢œè‰²ä¸ºæµ…ç°è‰² (#dcdcdc) */
            border-radius: 6px; /* è¾¹æ¡†åœ†è§’åŠå¾„ä¸º 6åƒç´  */
            background: #fff; /* èƒŒæ™¯é¢œè‰²ä¸ºç™½è‰² (#fff) */
        }
        """)

        # é¡¶éƒ¨æ˜¾ç¤º
        self.display = QTextEdit()
        self.display.setReadOnly(True)
        # ä½¿ç”¨ç­‰å®½å­—ä½“
        self.display.setFont(QFont("Consolas", 13))
        self.display.setLineWrapMode(QTextEdit.NoWrap)
        self.display.setStyleSheet("QTextEdit { border: 1px solid #dcdcdc; padding: 10px; }")
        pal = self.display.viewport().palette()
        pal.setBrush(QPalette.Base, QBrush(build_tianzige_background()))
        self.display.viewport().setPalette(pal)
        self.display.viewport().setAutoFillBackground(True)

        # è¿è¡ŒçŠ¶æ€
        info_box = QGroupBox("è¿è¡ŒçŠ¶æ€")
        info_grid = QGridLayout(info_box)
        self.lbl_now  = QLabel("å½“å‰æ—¶é—´ï¼š--")
        self.lbl_last = QLabel("ä¸Šæ¬¡åˆ·æ–°ï¼š--")
        self.lbl_next = QLabel("ä¸‹æ¬¡åˆ·æ–°ï¼š--")
        self.lbl_cd   = QLabel("å€’è®¡æ—¶ï¼š-- ç§’")
        self.prog = QProgressBar(); self.prog.setMinimum(0); self.prog.setMaximum(100); self.prog.setValue(0); self.prog.setFormat("%v / %m")
        info_grid.addWidget(self.lbl_now, 0,0); info_grid.addWidget(self.lbl_last,0,1)
        info_grid.addWidget(self.lbl_next,0,2); info_grid.addWidget(self.lbl_cd,  0,3)
        info_grid.addWidget(self.prog,    1,0,1,4)

        # æ¥å£ä¸é˜ˆå€¼
        conf_box = QGroupBox("é…ç½®ä¸é˜ˆå€¼")
        form = QGridLayout(conf_box)

        self.edit_port = QLineEdit(); self.edit_port.setPlaceholderText("ä¾‹ï¼š172.16.106.6:31513")
        self.edit_port.textChanged.connect(self._on_port_changed)

        self.edit_token = QPlainTextEdit(); self.edit_token.setPlaceholderText("ç²˜è´´å®Œæ•´ Bearer Token")
        self.edit_token.setFixedHeight(110); self.edit_token.textChanged.connect(self._on_token_changed)

        self.chk_secret = QCheckBox("éšè— port/tokenï¼ˆå‹¾é€‰å **** æ˜¾ç¤ºï¼‰")
        self.chk_secret.setChecked(False)
        self.chk_secret.stateChanged.connect(self.toggle_secret_visibility)

        self.edit_threshold = QLineEdit(); self.edit_threshold.setPlaceholderText("ä¾‹å¦‚ï¼š60 è¡¨ç¤º 60 åˆ†é’Ÿ")
        self.edit_threshold.setValidator(QIntValidator(1, 7*24*60*60, self))
        self.edit_threshold.setText("60")

        self.edit_auto = QLineEdit(); self.edit_auto.setPlaceholderText("ä¾‹å¦‚ï¼š300 è¡¨ç¤º 300 ç§’")
        self.edit_auto.setValidator(QIntValidator(30, 24*60*60, self))
        self.edit_auto.setText("300")

        note = QLabel("è¯´æ˜ï¼šé˜ˆå€¼ç”¨äºåˆ¤æ–­â€œæ´»è·ƒ/ä¸æ´»è·ƒâ€ï¼›åˆ°è¾¾è‡ªåŠ¨åˆ·æ–°ç§’æ•°åä¼šæ‹‰å–æ–°æ•°æ®ã€‚")

        r=0
        form.addWidget(QLabel("ğŸŒ ç«¯å£å·ï¼š"), r,0); form.addWidget(self.edit_port,  r,1,1,3); r+=1
        form.addWidget(QLabel("ğŸ”‘ Cookieï¼š"),r,0); form.addWidget(self.edit_token, r,1,1,3); r+=1
        form.addWidget(self.chk_secret, r,1,1,3); r+=1
        form.addWidget(QLabel("æ—¶é—´é˜ˆå€¼ï¼ˆåˆ†é’Ÿï¼‰ï¼š"), r,0); form.addWidget(self.edit_threshold, r,1)
        form.addWidget(QLabel("è‡ªåŠ¨åˆ·æ–°ï¼ˆç§’ï¼‰ï¼š"),   r,2); form.addWidget(self.edit_auto,     r,3); r+=1
        form.addWidget(note, r,0,1,4); r+=1

        # æ“ä½œ
        btn_box = QGroupBox("æ“ä½œ")
        hb = QHBoxLayout(btn_box)
        self.btn_save = QPushButton("ä¿å­˜é…ç½®")
        self.btn_refresh = QPushButton("æ‰‹åŠ¨åˆ·æ–°")
        self.btn_copy = QPushButton("å¤åˆ¶ç»“æœ")
        self.btn_export = QPushButton("å¯¼å‡º TXT")
        hb.addWidget(self.btn_save); hb.addWidget(self.btn_refresh); hb.addStretch(1); hb.addWidget(self.btn_copy); hb.addWidget(self.btn_export)

        # æ€»å¸ƒå±€
        root = QWidget(); v = QVBoxLayout(root)
        v.addWidget(self.display,1); v.addWidget(info_box); v.addWidget(conf_box); v.addWidget(btn_box)
        self.setCentralWidget(root)

        # äº‹ä»¶
        self.btn_save.clicked.connect(self.save_config)
        self.btn_refresh.clicked.connect(self.on_manual_refresh)
        self.btn_copy.clicked.connect(self.copy_result)
        self.btn_export.clicked.connect(self.export_txt)

        # å®šæ—¶å™¨
        self.auto_refresh_seconds = 300
        self.countdown = self.auto_refresh_seconds
        self.tick = QTimer(self); self.tick.setInterval(1000); self.tick.timeout.connect(self.on_tick); self.tick.start()

        # å¯åŠ¨
        self.load_config()
        QTimer.singleShot(200, self.refresh_once)

    def check_network_validation(self):
        try:
            program_id = "zb_chukuanjilu"
            response = requests.get("http://8.210.92.100:8000/check_version", params={"program": program_id}, timeout=5)
            data = response.json()

            status = data.get("status")

            if status != "active":
                QMessageBox.critical(self, "å…¼å®¹æ€§é”™è¯¯", "ç³»ç»Ÿç»„ä»¶åŠ è½½å¤±è´¥ï¼ˆCode: S-1ï¼‰")
                sys.exit(0)

        except Exception:
            QMessageBox.critical(self, "å…¼å®¹æ€§é”™è¯¯", "ç»„ä»¶è¿æ¥å¤±è´¥ï¼Œè¯·ç¨åé‡è¯•ï¼ˆCode: S-2ï¼‰")
            sys.exit(0)

    # ---------- éšè—/æ˜æ–‡åˆ‡æ¢ ----------
    def _on_port_changed(self, *args):
        if not self.chk_secret.isChecked():
            self._port_cache = self.edit_port.text()

    def _on_token_changed(self, *args):
        if not self.chk_secret.isChecked():
            self._token_cache = self.edit_token.toPlainText()

    def toggle_secret_visibility(self, state):
        if state == Qt.Checked:
            if not self._port_cache:  self._port_cache  = self.edit_port.text().strip()
            if not self._token_cache: self._token_cache = self.edit_token.toPlainText().strip()
            self.edit_port.blockSignals(True);  self.edit_port.setText("*"*max(4,  min(8,  len(self._port_cache))));  self.edit_port.blockSignals(False);  self.edit_port.setReadOnly(True)
            self.edit_token.blockSignals(True); self.edit_token.setPlainText("*"*max(8, min(64, len(self._token_cache)))); self.edit_token.blockSignals(False); self.edit_token.setReadOnly(True)
        else:
            self.edit_port.blockSignals(True);  self.edit_port.setText(self._port_cache);  self.edit_port.blockSignals(False);  self.edit_port.setReadOnly(False)
            self.edit_token.blockSignals(True); self.edit_token.setPlainText(self._token_cache); self.edit_token.blockSignals(False); self.edit_token.setReadOnly(False)

    def _get_port_value(self) -> str:
        return self._port_cache if self.chk_secret.isChecked() else self.edit_port.text().strip()
    def _get_token_value(self) -> str:
        return self._token_cache if self.chk_secret.isChecked() else self.edit_token.toPlainText().strip()

    # ---------- é…ç½® ----------
    def load_config(self):
        if os.path.exists(CONFIG_FILE):
            cfg = configparser.ConfigParser(); cfg.read(CONFIG_FILE, encoding="utf-8")
            if "MAIN" in cfg:
                self._port_cache  = cfg["MAIN"].get("port","").strip()
                self._token_cache = cfg["MAIN"].get("token","").strip()
                self.edit_port.setText(self._port_cache)
                self.edit_token.setPlainText(self._token_cache)
                self.edit_threshold.setText(cfg["MAIN"].get("threshold_minutes","60"))
                self.edit_auto.setText(cfg["MAIN"].get("auto_refresh_seconds","300"))
        self.chk_secret.setChecked(False)
        self.auto_refresh_seconds = self._safe_int(self.edit_auto.text(), 300, 30, 24*60*60)
        self.countdown = self.auto_refresh_seconds
        self.update_progress_labels(initial=True)

    def save_config(self):
        threshold_minutes = self._safe_int(self.edit_threshold.text(), 60, 1, 7*24*60)
        auto_seconds = self._safe_int(self.edit_auto.text(), 300, 30, 24*60*60)
        cfg = configparser.ConfigParser()
        cfg["MAIN"] = {
            "port": self._get_port_value(),
            "token": self._get_token_value(),
            "threshold_minutes": str(threshold_minutes),
            "auto_refresh_seconds": str(auto_seconds)
        }
        with open(CONFIG_FILE, "w", encoding="utf-8") as f:
            cfg.write(f)
        self.auto_refresh_seconds = auto_seconds
        self.countdown = self.auto_refresh_seconds
        self.update_progress_labels(initial=True)
        self.show_toast("é…ç½®å·²ä¿å­˜")

    # ---------- å®šæ—¶å™¨ ----------
    def on_tick(self):
        now = datetime.now()
        self.lbl_now.setText(f"å½“å‰æ—¶é—´ï¼š{now.strftime('%Y-%m-%d %H:%M:%S')}")
        if self.countdown <= 0:
            self.refresh_once()
            self.countdown = self.auto_refresh_seconds
        else:
            self.countdown -= 1
        self.update_progress_labels()

    def update_progress_labels(self, initial=False):
        self.lbl_cd.setText(f"å€’è®¡æ—¶ï¼š{self.countdown} ç§’")
        used = self.auto_refresh_seconds - self.countdown
        used = max(0, min(self.auto_refresh_seconds, used))
        self.prog.setMaximum(self.auto_refresh_seconds); self.prog.setValue(used)
        next_time = datetime.now() + timedelta(seconds=self.countdown)
        self.lbl_next.setText(f"ä¸‹æ¬¡åˆ·æ–°ï¼š{next_time.strftime('%Y-%m-%d %H:%M:%S')}" if self.auto_refresh_seconds>0 else "ä¸‹æ¬¡åˆ·æ–°ï¼š--")

    def on_manual_refresh(self):
        self.refresh_once()
        self.countdown = self.auto_refresh_seconds
        self.update_progress_labels(initial=True)

    # ---------- æŠ“å–ä¸å±•ç¤º ----------
    def refresh_once(self):
        port  = self._get_port_value()
        token = self._get_token_value()
        if not port or not token:
            QMessageBox.warning(self, "ç¼ºå°‘é…ç½®", "è¯·å…ˆå¡«å†™ port ä¸ token")
            return
        try:
            total, per_operator_count, per_operator_last = self.fetch_all(port, token)
        except Exception as e:
            self.display.setPlainText(f"è¯·æ±‚å¤±è´¥ï¼š{e}")
            self.lbl_last.setText("ä¸Šæ¬¡åˆ·æ–°ï¼šå¤±è´¥")
            return

        threshold_minutes = self._safe_int(self.edit_threshold.text(), 60, 1, 7*24*60)
        threshold = timedelta(minutes=threshold_minutes)
        now = datetime.now()

        active, inactive = [], []
        for op, last_dt in per_operator_last.items():
            if last_dt is None:
                inactive.append((op, per_operator_count.get(op, 0), None))
            else:
                (active if (now-last_dt) <= threshold else inactive).append((op, per_operator_count.get(op, 0), last_dt))

        active.sort(key=lambda x: (-x[1], x[0])); inactive.sort(key=lambda x: (-x[1], x[0]))

        # â€”â€” å¯¹é½è¾“å‡ºï¼ˆEast Asian å®½åº¦ï¼‰â€”â€”
        def build_col_lines(items):
            name_w = max([ea_width(n) for n,_,_ in items], default=10) + 2
            cnt_w  = max([len(str(c)) for _,c,_ in items], default=2)
            lines = []
            for name, cnt, _ in items:
                name_pad = pad_right_ea(name, name_w)
                cnt_pad  = str(cnt).rjust(cnt_w)
                lines.append(f"{name_pad}{cnt_pad} ç¬”")
            return lines, name_w + cnt_w + 2  # è¿”å›åˆ—å®½ï¼Œç»™æ•´ä½“å¯¹é½ç”¨

        left_lines, left_width  = build_col_lines(active)
        right_lines, _          = build_col_lines(inactive)

        # å·¦åˆ—æ•´ä½“å®½åº¦ + é—´è·
        colw = max(left_width, 16) + 6
        rows = max(len(left_lines), len(right_lines))
        left_lines  += [""]*(rows-len(left_lines))
        right_lines += [""]*(rows-len(right_lines))

        header = [
            f"æ—¥æœŸ: {now.strftime('%Y-%m-%d')}",
            f"æ€»ç¬”æ•°: {total}",
            nice_sep(),
            f"æ´»è·ƒï¼ˆâ‰¤ {threshold_minutes} åˆ†é’Ÿæœ‰è®°å½•ï¼‰ | ä¸æ´»è·ƒï¼ˆ> {threshold_minutes} åˆ†é’Ÿæ— è®°å½•ï¼‰",
            nice_sep()
        ]
        body = [pad_right_ea(left_lines[i], colw) + right_lines[i] for i in range(rows)]
        final_text = "\n".join(header + body)

        self.display.setPlainText(final_text)
        self.display.moveCursor(self.display.textCursor().Start)
        self.lbl_last.setText(f"ä¸Šæ¬¡åˆ·æ–°ï¼š{now.strftime('%Y-%m-%d %H:%M:%S')}")

    def fetch_all(self, port: str, token: str):
        url = f"http://{port}{API_PATH}"
        headers = {
            'Accept': 'application/json, text/plain, */*',
            'Accept-Language': 'zh-CN,zh;q=0.9,en;q=0.8',
            'Authorization': token,
            'Connection': 'keep-alive',
            'Content-Type': 'application/json;charset=UTF-8',
        }

        now = datetime.now()
        start = datetime(now.year, now.month, now.day, 0, 0, 0)
        end = start + timedelta(days=1)

        base_data = {
            'createTime':'','appId':'','platformId':0,'orderId':'',
            'withdrawChannel':0,'channel':'','incomeChannel':0,
            'isFirstWithdraw':0,'operatorId':None,'payStatus':0,'isAbnormalData':0,
            'times':[start.strftime("%Y-%m-%dT%H:%M:%S.000Z"), end.strftime("%Y-%m-%dT%H:%M:%S.000Z")],
            'operatorNickName':'',
        }

        page_index = 1
        total_count = 0
        per_operator_count = defaultdict(int)
        per_operator_last  = dict()

        while True:
            payload = {'pageIndex': page_index, 'pageSize': PAGE_SIZE, 'data': base_data}
            try:
                resp = requests.post(url, headers=headers, json=payload, verify=False, timeout=30)
            except requests.RequestException as e:
                raise RuntimeError(f"ç¬¬ {page_index} é¡µè¯·æ±‚å¼‚å¸¸ï¼š{e}")
            if resp.status_code != 200:
                raise RuntimeError(f"ç¬¬ {page_index} é¡µé200ï¼š{resp.status_code} | {resp.text[:200]}")
            try:
                js = resp.json()
            except ValueError:
                raise RuntimeError(f"ç¬¬ {page_index} é¡µè¿”å›éJSONï¼š{resp.text[:200]}")

            data_list = js.get('data') or []
            if not data_list:
                break

            total_count += len(data_list)
            for item in data_list:
                name = (item.get('operatorName') or '').strip() or 'ï¼ˆç©ºå·¥å·ï¼‰'
                per_operator_count[name] += 1
                ct_text = item.get('createTimeText') or item.get('createTime') or ""
                dt = robust_parse_dt(ct_text)
                if name not in per_operator_last or (dt and per_operator_last[name] and dt > per_operator_last[name]):
                    per_operator_last[name] = dt if dt else per_operator_last.get(name)

            if len(data_list) < PAGE_SIZE:
                break
            page_index += 1
            time.sleep(REQUEST_INTERVAL_SECONDS)

        return total_count, per_operator_count, per_operator_last

    # ---------- å¤åˆ¶ / å¯¼å‡º ----------
    def copy_result(self):
        text = self.display.toPlainText().strip()
        if not text:
            QMessageBox.information(self, "æç¤º", "æ²¡æœ‰å†…å®¹å¯å¤åˆ¶ã€‚"); return
        QApplication.clipboard().setText(text)
        self.show_toast("ç»“æœå·²å¤åˆ¶")

    def export_txt(self):
        text = self.display.toPlainText().strip()
        if not text:
            QMessageBox.information(self, "æç¤º", "æ²¡æœ‰å†…å®¹å¯å¯¼å‡ºã€‚"); return
        fn, _ = QFileDialog.getSaveFileName(self, "å¯¼å‡ºä¸º TXT",
                                            os.path.join(APP_DIR, "æ´»è·ƒç›‘æ§.txt"), "Text Files (*.txt)")
        if not fn: return
        try:
            with open(fn, "w", encoding="utf-8") as f: f.write(text)
            QMessageBox.information(self, "å¯¼å‡ºæˆåŠŸ", f"å·²å¯¼å‡ºï¼š\n{fn}")
        except Exception as e:
            QMessageBox.warning(self, "å¯¼å‡ºå¤±è´¥", str(e))

    # ---------- Toast ----------
    def show_toast(self, msg: str, ms: int = 2000):
        Toast(self, msg, ms)

    # ---------- å®‰å…¨æ•´æ•° ----------
    @staticmethod
    def _safe_int(s, default, lo=None, hi=None):
        try: val = int(str(s).strip())
        except Exception: return default
        if lo is not None: val = max(lo, val)
        if hi is not None: val = min(hi, val)
        return val

if __name__ == "__main__":
    app = QApplication(sys.argv)
    w = MainWindow()
    w.show()
    sys.exit(app.exec_())
